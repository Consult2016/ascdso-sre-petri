/*!
 * new-relic-angular-client
 * https://github.com/wix/new-relic-angular-client
 * Created: 2016-04-03T09:01:19.042Z
 * License: 
 */
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};angular.module("nr-ng-client",[]).run(["nrNgClient","nrNgUiRouter",function(){}]);var relic;!function(t){var e=function(){function t(){this.newrelic=window.newrelic}return t.prototype.tag=function(t,e){this.newrelic&&this.newrelic.setCustomAttribute(t,e)},t.prototype.addPageAction=function(t,e){this.newrelic&&this.newrelic.addPageAction(t,e)},t.prototype.reportError=function(t,e){if(this.newrelic)try{throw"string"==typeof t?new Error(t):t}catch(r){this.newrelic.noticeError(r),"function"==typeof this.newrelic.addPageAction&&this.newrelic.addPageAction("error",{href:window.location.href,message:r.message,stack:r.stack,cause:e||""})}},t.prototype.reportFinishLoading=function(){this.newrelic&&this.newrelic.finished()},t}();t.NrNgClient=e;var r=function(t){function r(){t.apply(this,arguments),this.config={reportError:!0,reportFinish:!0}}return __extends(r,t),r.prototype.reportFinishedEnabled=function(t){this.config.reportFinish=t},r.prototype.reportErrorsEnabled=function(t){this.config.reportError=t},r.prototype.decorateExceptionHandler=function(t){var e=this;this.newrelic&&this.config.reportError&&t.decorator("$exceptionHandler",["$delegate",function(t){return function(r,n){e.reportError(r,n),t(r,n)}}])},r.prototype.$get=function(t,r){var n=this;return this.config.reportFinish&&r(function(){t.notifyWhenNoOutstandingRequests(function(){n.reportFinishLoading()})},0,!1),new e},r.prototype.$get.$inject=["$browser","$timeout"],r}(e);t.NrNgClientProvider=r,angular.module("nr-ng-client").provider("nrNgClient",r).config(["$provide","nrNgClientProvider",function(t,e){e.decorateExceptionHandler(t)}])}(relic||(relic={}));var relic;!function(t){var e="$stateChangeStart",r="$viewContentLoaded",n=function(){function t(t,e){this.$state=t,this.addStateToTrace=e}return t.prototype.reportStateDataLoaded=function(){this.$state&&this.addStateToTrace(this.$state.current.url)},t}();t.NrNgUiRouter=n;var o=function(){function t(){this.newrelic=window.newrelic,this.config={reportStateChange:!0,threshold:300},this.routsData={start:0,inTransition:!1}}return t.prototype.stateChangedReportEnabled=function(t){this.config.reportStateChange=t},t.prototype.threshold=function(t){this.config.threshold=t},t.prototype.registerStateChangeEvents=function(t,n,o){var i=this;t.$on(e,function(t,e,r,n){n&&n.name&&(i.routsData.start=Date.now(),i.routsData.inTransition=!0)}),this.config.reportStateChange&&t.$on(r,function(){i.routsData.inTransition&&n.notifyWhenNoOutstandingRequests(function(){i.addStateToTrace(o.current.url)})})},t.prototype.addStateToTrace=function(t){this.routsData.inTransition=!1,this.newrelic&&Date.now()-this.routsData.start>=this.config.threshold&&(this.newrelic.addToTrace({name:"RENDER_STATE"+t,start:this.routsData.start,end:Date.now()}),this.newrelic.addPageAction("RENDER_STATE"+t,{duration:(Date.now()-this.routsData.start)/1e3}))},t.prototype.getStateService=function(t){var e,r="$state";try{var n=t.has(r);n&&(e=t.get(r))}catch(o){}return e},t.prototype.$get=function(t,e,r){var o=this,i=this.getStateService(r);return i&&this.registerStateChangeEvents(t,e,i),new n(i,function(t){return o.addStateToTrace(t)})},t.prototype.$get.$inject=["$rootScope","$browser","$injector"],t}();t.NrNgUiRouterProvider=o,angular.module("nr-ng-client").provider("nrNgUiRouter",o)}(relic||(relic={}));